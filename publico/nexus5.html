<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Visual com Controle Granular - Nexus 5</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide-icons@latest/dist/lucide.js"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-config.js"></script>

    <!-- Alpine.js Core - 'defer' é crucial para garantir que o DOM esteja pronto antes da execução -->
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Alpine Component Definition - Movido para o <head> para garantir o carregamento correto -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('pageEditor', () => ({
                isReady: false,
                isSaving: false,
                toast: { show: false, message: '', type: 'success' },
                pageData: {}, // Começa vazio e carrega da estrutura padrão/Firebase
                
                // Estrutura de dados padrão com todo o conteúdo original
                defaultPageData: {
                    hero: {
                        visible: true,
                        headline1: { value: 'O Fim do Bloqueio Criativo.', visible: true },
                        headline2: { value: 'O Início da Sua Obra-Prima.', visible: true },
                        paragraph: { value: 'A ferramenta definitiva que faltava para transformar suas ideias em som com a velocidade do pensamento.', visible: true },
                        videoUrl: { value: 'https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=1&controls=1&loop=1&playlist=dQw4w9WgXcQ', visible: true },
                        ctaButtonText: { value: 'QUERO DESBLOQUEAR MINHA CRIATIVIDADE AGORA', visible: true },
                        ctaLink: { value: 'https://pay.hotmart.com/', visible: true },
                    },
                    problem: {
                        visible: true,
                        title: { value: 'Sua criatividade está presa?', visible: true },
                        points: [
                            { title: 'Horas Perdidas', desc: 'Passar horas caçando o timbre perfeito, apenas para ver a inspiração inicial desaparecer.', visible: true },
                            { title: 'Workflow Quebrado', desc: 'Pular entre 10 plugins diferentes, quebrando o fluxo criativo e sobrecarregando sua CPU.', visible: true },
                            { title: 'Ideias no Limbo', desc: 'Ter uma ideia genial na cabeça, mas não conseguir traduzi-la em som por limitações técnicas.', visible: true }
                        ]
                    },
                    solution: {
                        visible: true,
                        imageUrl: { value: 'https://placehold.co/600x600/0A0A0A/00F0FF?text=Aura+Engine', visible: true },
                        title: { value: "Apresentando o <span class='gradient-text'>Aura Engine</span>", visible: true },
                        description: { value: 'Mais que um instrumento. Um ecossistema sônico inteligente projetado para ser uma extensão da sua mente. O Aura Engine une síntese de ponta, sampling intuitivo e um workflow revolucionário para que você nunca mais perca uma ideia.', visible: true },
                        features: [
                            { title: 'Síntese Neural', desc: 'Descreva o som que você imagina e nossa IA o materializa em segundos.', visible: true },
                            { title: 'Fluxo Unificado', desc: 'Grave, module, sequencie e masterize em um único lugar, com uma interface que inspira.', visible: true },
                            { title: 'Biblioteca Infinita', desc: 'Acesso a uma nuvem de presets e samples dos maiores produtores, atualizada semanalmente.', visible: true }
                        ]
                    },
                    testimonials: {
                        visible: true,
                        title: { value: 'Não acredite apenas na nossa palavra.', visible: true },
                        items: [
                            { image: 'https://placehold.co/100x100/1D1D1D/FFFFFF?text=DJ', name: 'DJ Alex Groove', role: 'Artista Internacional', text: '"O Aura Engine está no centro do meu novo álbum. A capacidade de criar sons únicos tão rápido é simplesmente revolucionária. Indispensável."', visible: true },
                            { image: 'https://placehold.co/100x100/1D1D1D/FFFFFF?text=Produtora', name: 'Juliana Reis', role: 'Produtora Musical (Gold Certified)', text: '"Economizei dezenas de horas no meu último projeto. O workflow é genial e a qualidade sonora é impecável. Compra certa."', visible: true },
                            { image: 'https://placehold.co/100x100/1D1D1D/FFFFFF?text=Beatmaker', name: 'Léo "Beats" Costa', role: 'Beatmaker & Sound Designer', text: '"Finalmente uma ferramenta que entende a minha visão. O som é orgânico, vivo, e me permite experimentar de formas que eu não achava possível."', visible: true }
                        ]
                    },
                    offer: {
                        visible: true,
                        title: { value: 'Sua Oportunidade <span class="gradient-text">ÚNICA</span> de Elevar Seu Som', visible: true },
                        subtitle: { value: 'Acesso vitalício ao Aura Engine com um desconto massivo de lançamento.', visible: true },
                        oldPrice: { value: 'De R$1.297,00', visible: true },
                        price: { value: '12x de R$79,90', visible: true },
                        fullPrice: { value: 'ou R$797 à vista no PIX', visible: true },
                        bonusTitle: { value: 'COMPRE HOJE E RECEBA 3 BÔNUS EXCLUSIVOS (<span class="text-pink-400">VALOR R$891</span>):', visible: true },
                        bonuses: [
                            { text: 'Masterclass "Sound Design Avançado".', visible: true },
                            { text: 'Pacote de Samples "Analog Dreams" (Valor R$297).', visible: true },
                            { text: 'Acesso Vitalício à Comunidade VIP de Produtores.', visible: true }
                        ],
                        ctaButtonText: { value: 'QUERO GARANTIR MEU ACESSO COM DESCONTO', visible: true },
                    },
                    guarantee: {
                        visible: true,
                        imageUrl: { value: 'https://placehold.co/150x150/0A0A0A/00F0FF?text=30+DIAS', visible: true },
                        title: { value: 'Garantia Blindada de 30 Dias', visible: true },
                        text: { value: 'O nosso compromisso é com a sua evolução musical. Por isso, oferecemos uma garantia incondicional. Ou você ama o Aura Engine e sente a transformação na sua música nos próximos 30 dias, ou nós devolvemos 100% do seu dinheiro. Sem perguntas, sem burocracia. O risco é todo nosso.', visible: true },
                    },
                    faq: {
                        visible: true,
                        title: { value: 'Perguntas Frequentes', visible: true },
                        items: [
                            { q: 'Para quem é o Aura Engine?', a: 'O Aura Engine foi feito para produtores musicais, beatmakers e DJs de todos os níveis que desejam quebrar barreiras criativas, agilizar o workflow e criar sons verdadeiramente únicos.', visible: true },
                            { q: 'Preciso de um computador potente?', a: 'Otimizamos o Aura Engine para ser extremamente eficiente. Ele roda bem na maioria dos sistemas modernos, mas recomendamos pelo menos 8GB de RAM e um processador i5 ou equivalente para uma experiência fluida.', visible: true },
                            { q: 'Como recebo o acesso?', a: 'O acesso é imediato após a confirmação do pagamento. Você receberá um e-mail com seu login, senha e o link para download do software e acesso a todos os bônus.', visible: true }
                        ]
                    }
                },

                pageRef: null,

                init() {
                    this.pageData = JSON.parse(JSON.stringify(this.defaultPageData)); // Cópia profunda
                    this.pageRef = db.collection('pages').doc('nexus5_granular_expanded');
                    auth.onAuthStateChanged(user => {
                        if (user) {
                            this.loadPageData().then(() => {
                                this.isReady = true;
                                this.$nextTick(() => lucide.createIcons());
                            });
                        } else {
                            window.location.href = 'login.html';
                        }
                    });
                },

                async loadPageData() {
                    try {
                        const doc = await this.pageRef.get();
                        if (doc.exists) {
                            const firestoreData = doc.data();
                            this.pageData = this.mergeDeep(JSON.parse(JSON.stringify(this.defaultPageData)), firestoreData);
                        } else {
                            // Se o documento não existe, salva a estrutura padrão para começar
                            await this.savePageData(false); 
                        }
                    } catch (error) {
                        console.error("Erro ao carregar dados:", error);
                        this.showToast('Não foi possível carregar os dados.', 'error');
                    }
                },

                async savePageData(showNotification = true) {
                    if (this.isSaving) return;
                    this.isSaving = true;
                    try {
                        await this.pageRef.set(this.pageData);
                        if (showNotification) this.showToast('Alterações salvas com sucesso!', 'success');
                    } catch (error) {
                        console.error("Erro ao salvar:", error);
                        this.showToast('Erro ao salvar.', 'error');
                    } finally {
                        this.isSaving = false;
                    }
                },
                
                addItem(sectionName, key) {
                    const section = this.pageData[sectionName];
                    if (section && Array.isArray(section[key])) {
                        const firstItem = this.defaultPageData[sectionName][key][0];
                        const newItem = JSON.parse(JSON.stringify(firstItem)); // Cópia profunda
                        // Reseta os valores para strings vazias
                        Object.keys(newItem).forEach(prop => {
                            if(prop !== 'visible') newItem[prop] = '';
                        });
                        newItem.visible = true;
                        section[key].push(newItem);
                    }
                },

                removeItem(sectionName, key, index) {
                    const section = this.pageData[sectionName];
                    if (section && Array.isArray(section[key])) {
                        section[key].splice(index, 1);
                    }
                },

                showToast(message, type = 'success') {
                    this.toast.message = message;
                    this.toast.type = type;
                    this.toast.show = true;
                    setTimeout(() => this.toast.show = false, 3000);
                },

                // Função para mesclar dados do Firebase com a estrutura padrão, garantindo que novos campos sejam adicionados
                mergeDeep(target, source) {
                    const isObject = (obj) => obj && typeof obj === 'object' && !Array.isArray(obj);
                    const output = { ...target };
                    if (isObject(target) && isObject(source)) {
                        Object.keys(source).forEach(key => {
                            if (isObject(source[key])) {
                                if (!(key in target))
                                    Object.assign(output, { [key]: source[key] });
                                else
                                    output[key] = this.mergeDeep(target[key], source[key]);
                            } else if (Array.isArray(source[key])) {
                                output[key] = [];
                                source[key].forEach((item, index) => {
                                    const targetItem = target[key] && target[key][index] ? target[key][index] : {};
                                    output[key][index] = this.mergeDeep(targetItem, item);
                                });
                            } else {
                                Object.assign(output, { [key]: source[key] });
                            }
                        });
                    }
                    return output;
                }
            }));
        });
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        .label { @apply block text-sm font-medium text-gray-700 mb-1; }
        .input { @apply mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm; }
        .textarea { @apply mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm; }
        .btn-add { @apply mt-4 w-full text-center bg-green-100 text-green-800 hover:bg-green-200 font-semibold py-2 px-4 rounded-md flex items-center justify-center text-sm transition-colors; }
        .btn-remove { @apply text-red-500 hover:text-red-700 transition-colors; }
        [x-cloak] { display: none !important; }
        
        .toggle-bg:after { content: ''; @apply absolute top-0.5 left-0.5 bg-white border border-gray-300 rounded-full h-5 w-5 transition shadow-sm; }
        input:checked + .toggle-bg:after { @apply transform translate-x-full; }
        input:checked + .toggle-bg { @apply bg-indigo-600 border-indigo-600; }

        .visibility-toggle { @apply cursor-pointer text-gray-400 hover:text-indigo-600 transition-colors; }
        .field-group.is-hidden .label, 
        .field-group.is-hidden .input, 
        .field-group.is-hidden .textarea { @apply opacity-50; }
        .field-group.is-hidden .visibility-toggle { @apply text-gray-300; }

        .preview-pane {
            background-color: #000000; color: #E0E0E0;
            background-image: linear-gradient(rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.98)), url('https://images.unsplash.com/photo-1619983081563-436f63e02242?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover; background-position: center; background-attachment: fixed;
        }
        .gradient-text { background: linear-gradient(90deg, #00F0FF, #D400FF); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 1rem; border: 2px solid #4F46E5; box-shadow: 0 0 40px rgba(79, 70, 229, 0.6); }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .ui-panel { background-color: rgba(10, 10, 10, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
    </style>
</head>
<body x-data="pageEditor" class="bg-gray-100" x-cloak>

    <div x-show="!isReady" class="flex items-center justify-center h-screen">
        <p class="text-lg text-gray-600">A carregar editor...</p>
    </div>

    <div x-show="isReady">
        <!-- Header -->
        <header class="bg-white shadow-md sticky top-0 z-30">
            <div class="max-w-full mx-auto py-3 px-4 sm:px-6 lg:px-8 flex justify-between items-center">
                <h1 class="text-xl font-bold text-gray-900">Editor Visual Granular</h1>
                <div class="flex items-center space-x-4">
                     <a href="admin.html" class="text-sm font-medium text-indigo-600 hover:text-indigo-800">&larr; Voltar ao Painel</a>
                    <button @click="savePageData()" :disabled="isSaving" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-md flex items-center transition-colors disabled:opacity-50">
                        <i data-lucide="save" class="w-5 h-5 mr-2"></i>
                        <span x-show="!isSaving">Salvar Alterações</span>
                        <span x-show="isSaving">Salvando...</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Layout -->
        <div class="grid grid-cols-1 lg:grid-cols-2 h-screen">
            
            <!-- Editor Column -->
            <div class="lg:col-span-1 p-6 overflow-y-auto" style="height: calc(100vh - 68px);">
                <div class="space-y-6">
                    
                    <!-- Section: Hero -->
                    <div class="bg-white p-4 rounded-lg shadow">
                        <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: Hero</h3>
                            <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.hero.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.hero.visible" x-transition class="space-y-4 mt-4">
                            <!-- headline1 -->
                            <div class="field-group" :class="{'is-hidden': !pageData.hero.headline1.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Título 1</label>
                                    <i @click="pageData.hero.headline1.visible = !pageData.hero.headline1.visible" class="visibility-toggle" :data-lucide="pageData.hero.headline1.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.hero.headline1.value" class="input">
                            </div>
                            <!-- headline2 -->
                            <div class="field-group" :class="{'is-hidden': !pageData.hero.headline2.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Título 2</label>
                                    <i @click="pageData.hero.headline2.visible = !pageData.hero.headline2.visible" class="visibility-toggle" :data-lucide="pageData.hero.headline2.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.hero.headline2.value" class="input">
                            </div>
                            <!-- paragraph -->
                            <div class="field-group" :class="{'is-hidden': !pageData.hero.paragraph.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Parágrafo</label>
                                    <i @click="pageData.hero.paragraph.visible = !pageData.hero.paragraph.visible" class="visibility-toggle" :data-lucide="pageData.hero.paragraph.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <textarea x-model="pageData.hero.paragraph.value" rows="3" class="textarea"></textarea>
                            </div>
                            <!-- videoUrl -->
                            <div class="field-group" :class="{'is-hidden': !pageData.hero.videoUrl.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">URL do Vídeo</label>
                                    <i @click="pageData.hero.videoUrl.visible = !pageData.hero.videoUrl.visible" class="visibility-toggle" :data-lucide="pageData.hero.videoUrl.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.hero.videoUrl.value" class="input">
                            </div>
                            <!-- ctaButtonText -->
                            <div class="field-group" :class="{'is-hidden': !pageData.hero.ctaButtonText.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Texto do Botão de Ação</label>
                                    <i @click="pageData.hero.ctaButtonText.visible = !pageData.hero.ctaButtonText.visible" class="visibility-toggle" :data-lucide="pageData.hero.ctaButtonText.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.hero.ctaButtonText.value" class="input">
                            </div>
                             <!-- ctaLink -->
                            <div class="field-group" :class="{'is-hidden': !pageData.hero.ctaLink.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Link do Botão de Ação</label>
                                    <i @click="pageData.hero.ctaLink.visible = !pageData.hero.ctaLink.visible" class="visibility-toggle" :data-lucide="pageData.hero.ctaLink.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.hero.ctaLink.value" class="input">
                            </div>
                        </div>
                    </div>

                    <!-- Section: Problem -->
                    <div class="bg-white p-4 rounded-lg shadow">
                        <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: Problema</h3>
                            <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.problem.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.problem.visible" x-transition class="space-y-4 mt-4">
                            <div class="field-group" :class="{'is-hidden': !pageData.problem.title.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Título da Seção</label>
                                    <i @click="pageData.problem.title.visible = !pageData.problem.title.visible" class="visibility-toggle" :data-lucide="pageData.problem.title.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.problem.title.value" class="input">
                            </div>
                            
                            <h4 class="font-semibold pt-2">Pontos do Problema</h4>
                            <template x-for="(item, index) in pageData.problem.points" :key="index">
                                <div class="border-t pt-4 mt-4 space-y-2 field-group" :class="{'is-hidden': !item.visible}">
                                    <div class="flex justify-between items-center">
                                        <h5 class="font-semibold" x-text="`Ponto #${index + 1}`"></h5>
                                        <div class="flex items-center space-x-3">
                                            <i @click="item.visible = !item.visible" class="visibility-toggle" :data-lucide="item.visible ? 'eye' : 'eye-off'"></i>
                                            <button @click="removeItem('problem', 'points', index)" class="btn-remove"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </div>
                                    </div>
                                    <div><label class="label">Título do Ponto</label><input type="text" x-model="item.title" class="input"></div>
                                    <div><label class="label">Descrição</label><input type="text" x-model="item.desc" class="input"></div>
                                </div>
                            </template>
                            <button @click="addItem('problem', 'points')" class="btn-add"><i data-lucide="plus" class="w-4 h-4 mr-2"></i>Adicionar Ponto</button>
                        </div>
                    </div>

                    <!-- Section: Solution -->
                    <div class="bg-white p-4 rounded-lg shadow">
                         <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: Solução</h3>
                            <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.solution.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.solution.visible" x-transition class="space-y-4 mt-4">
                            <div class="field-group" :class="{'is-hidden': !pageData.solution.imageUrl.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">URL da Imagem</label>
                                    <i @click="pageData.solution.imageUrl.visible = !pageData.solution.imageUrl.visible" class="visibility-toggle" :data-lucide="pageData.solution.imageUrl.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.solution.imageUrl.value" class="input">
                            </div>
                            <div class="field-group" :class="{'is-hidden': !pageData.solution.title.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Título da Seção</label>
                                    <i @click="pageData.solution.title.visible = !pageData.solution.title.visible" class="visibility-toggle" :data-lucide="pageData.solution.title.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.solution.title.value" class="input">
                            </div>
                            <div class="field-group" :class="{'is-hidden': !pageData.solution.description.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Descrição</label>
                                    <i @click="pageData.solution.description.visible = !pageData.solution.description.visible" class="visibility-toggle" :data-lucide="pageData.solution.description.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <textarea x-model="pageData.solution.description.value" rows="3" class="textarea"></textarea>
                            </div>

                            <h4 class="font-semibold pt-2">Benefícios</h4>
                            <template x-for="(item, index) in pageData.solution.features" :key="index">
                                <div class="border-t pt-4 mt-4 space-y-2 field-group" :class="{'is-hidden': !item.visible}">
                                    <div class="flex justify-between items-center">
                                        <h5 class="font-semibold" x-text="`Benefício #${index + 1}`"></h5>
                                        <div class="flex items-center space-x-3">
                                            <i @click="item.visible = !item.visible" class="visibility-toggle" :data-lucide="item.visible ? 'eye' : 'eye-off'"></i>
                                            <button @click="removeItem('solution', 'features', index)" class="btn-remove"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </div>
                                    </div>
                                    <div><label class="label">Título do Benefício</label><input type="text" x-model="item.title" class="input"></div>
                                    <div><label class="label">Descrição</label><input type="text" x-model="item.desc" class="input"></div>
                                </div>
                            </template>
                            <button @click="addItem('solution', 'features')" class="btn-add"><i data-lucide="plus" class="w-4 h-4 mr-2"></i>Adicionar Benefício</button>
                        </div>
                    </div>

                    <!-- Section: Testimonials -->
                    <div class="bg-white p-4 rounded-lg shadow">
                        <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: Depoimentos</h3>
                             <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.testimonials.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.testimonials.visible" x-transition class="space-y-4 mt-4">
                            <div class="field-group" :class="{'is-hidden': !pageData.testimonials.title.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Título da Seção</label>
                                    <i @click="pageData.testimonials.title.visible = !pageData.testimonials.title.visible" class="visibility-toggle" :data-lucide="pageData.testimonials.title.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.testimonials.title.value" class="input">
                            </div>

                            <h4 class="font-semibold pt-2">Itens de Depoimento</h4>
                            <template x-for="(item, index) in pageData.testimonials.items" :key="index">
                                <div class="border-t pt-4 mt-4 space-y-2 field-group" :class="{'is-hidden': !item.visible}">
                                    <div class="flex justify-between items-center">
                                        <h5 class="font-semibold" x-text="`Depoimento #${index + 1}`"></h5>
                                        <div class="flex items-center space-x-3">
                                            <i @click="item.visible = !item.visible" class="visibility-toggle" :data-lucide="item.visible ? 'eye' : 'eye-off'"></i>
                                            <button @click="removeItem('testimonials', 'items', index)" class="btn-remove"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </div>
                                    </div>
                                    <div><label class="label">Imagem (URL)</label><input type="text" x-model="item.image" class="input"></div>
                                    <div><label class="label">Nome</label><input type="text" x-model="item.name" class="input"></div>
                                    <div><label class="label">Cargo</label><input type="text" x-model="item.role" class="input"></div>
                                    <div><label class="label">Texto</label><textarea x-model="item.text" rows="3" class="textarea"></textarea></div>
                                </div>
                            </template>
                            <button @click="addItem('testimonials', 'items')" class="btn-add"><i data-lucide="plus" class="w-4 h-4 mr-2"></i>Adicionar Depoimento</button>
                        </div>
                    </div>

                    <!-- Section: Offer -->
                    <div class="bg-white p-4 rounded-lg shadow">
                         <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: Oferta</h3>
                             <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.offer.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.offer.visible" x-transition class="space-y-4 mt-4">
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.title.visible}"><div class="flex items-center justify-between"><label class="label">Título</label><i @click="pageData.offer.title.visible = !pageData.offer.title.visible" class="visibility-toggle" :data-lucide="pageData.offer.title.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.title.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.subtitle.visible}"><div class="flex items-center justify-between"><label class="label">Subtítulo</label><i @click="pageData.offer.subtitle.visible = !pageData.offer.subtitle.visible" class="visibility-toggle" :data-lucide="pageData.offer.subtitle.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.subtitle.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.oldPrice.visible}"><div class="flex items-center justify-between"><label class="label">Preço Antigo</label><i @click="pageData.offer.oldPrice.visible = !pageData.offer.oldPrice.visible" class="visibility-toggle" :data-lucide="pageData.offer.oldPrice.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.oldPrice.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.price.visible}"><div class="flex items-center justify-between"><label class="label">Preço Principal</label><i @click="pageData.offer.price.visible = !pageData.offer.price.visible" class="visibility-toggle" :data-lucide="pageData.offer.price.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.price.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.fullPrice.visible}"><div class="flex items-center justify-between"><label class="label">Preço à Vista</label><i @click="pageData.offer.fullPrice.visible = !pageData.offer.fullPrice.visible" class="visibility-toggle" :data-lucide="pageData.offer.fullPrice.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.fullPrice.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.bonusTitle.visible}"><div class="flex items-center justify-between"><label class="label">Título dos Bônus</label><i @click="pageData.offer.bonusTitle.visible = !pageData.offer.bonusTitle.visible" class="visibility-toggle" :data-lucide="pageData.offer.bonusTitle.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.bonusTitle.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.offer.ctaButtonText.visible}"><div class="flex items-center justify-between"><label class="label">Texto do Botão Final</label><i @click="pageData.offer.ctaButtonText.visible = !pageData.offer.ctaButtonText.visible" class="visibility-toggle" :data-lucide="pageData.offer.ctaButtonText.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.offer.ctaButtonText.value" class="input"></div>
                            
                            <h4 class="font-semibold pt-2">Bônus</h4>
                            <template x-for="(item, index) in pageData.offer.bonuses" :key="index">
                                <div class="border-t pt-4 mt-4 space-y-2 field-group" :class="{'is-hidden': !item.visible}">
                                    <div class="flex justify-between items-center">
                                        <h5 class="font-semibold" x-text="`Bônus #${index + 1}`"></h5>
                                        <div class="flex items-center space-x-3">
                                            <i @click="item.visible = !item.visible" class="visibility-toggle" :data-lucide="item.visible ? 'eye' : 'eye-off'"></i>
                                            <button @click="removeItem('offer', 'bonuses', index)" class="btn-remove"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </div>
                                    </div>
                                    <div><label class="label">Texto do Bônus</label><input type="text" x-model="item.text" class="input"></div>
                                </div>
                            </template>
                            <button @click="addItem('offer', 'bonuses')" class="btn-add"><i data-lucide="plus" class="w-4 h-4 mr-2"></i>Adicionar Bônus</button>
                        </div>
                    </div>

                    <!-- Section: Guarantee -->
                    <div class="bg-white p-4 rounded-lg shadow">
                        <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: Garantia</h3>
                             <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.guarantee.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.guarantee.visible" x-transition class="space-y-4 mt-4">
                            <div class="field-group" :class="{'is-hidden': !pageData.guarantee.imageUrl.visible}"><div class="flex items-center justify-between"><label class="label">URL da Imagem (Selo)</label><i @click="pageData.guarantee.imageUrl.visible = !pageData.guarantee.imageUrl.visible" class="visibility-toggle" :data-lucide="pageData.guarantee.imageUrl.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.guarantee.imageUrl.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.guarantee.title.visible}"><div class="flex items-center justify-between"><label class="label">Título</label><i @click="pageData.guarantee.title.visible = !pageData.guarantee.title.visible" class="visibility-toggle" :data-lucide="pageData.guarantee.title.visible ? 'eye' : 'eye-off'"></i></div><input type="text" x-model="pageData.guarantee.title.value" class="input"></div>
                            <div class="field-group" :class="{'is-hidden': !pageData.guarantee.text.visible}"><div class="flex items-center justify-between"><label class="label">Texto da Garantia</label><i @click="pageData.guarantee.text.visible = !pageData.guarantee.text.visible" class="visibility-toggle" :data-lucide="pageData.guarantee.text.visible ? 'eye' : 'eye-off'"></i></div><textarea x-model="pageData.guarantee.text.value" rows="3" class="textarea"></textarea></div>
                        </div>
                    </div>

                    <!-- Section: FAQ -->
                    <div class="bg-white p-4 rounded-lg shadow">
                        <div class="flex justify-between items-center border-b pb-2 mb-4">
                            <h3 class="font-bold text-lg">Seção: FAQ</h3>
                             <label class="flex items-center cursor-pointer">
                                <span class="text-sm font-medium text-gray-700 mr-3">Visível</span>
                                <div class="relative">
                                    <input type="checkbox" class="sr-only" x-model="pageData.faq.visible">
                                    <div class="toggle-bg bg-gray-200 border-2 border-transparent h-6 w-11 rounded-full"></div>
                                </div>
                            </label>
                        </div>
                        <div x-show="pageData.faq.visible" x-transition class="space-y-4 mt-4">
                            <div class="field-group" :class="{'is-hidden': !pageData.faq.title.visible}">
                                <div class="flex items-center justify-between">
                                    <label class="label">Título da Seção</label>
                                    <i @click="pageData.faq.title.visible = !pageData.faq.title.visible" class="visibility-toggle" :data-lucide="pageData.faq.title.visible ? 'eye' : 'eye-off'"></i>
                                </div>
                                <input type="text" x-model="pageData.faq.title.value" class="input">
                            </div>

                            <h4 class="font-semibold pt-2">Perguntas e Respostas</h4>
                            <template x-for="(item, index) in pageData.faq.items" :key="index">
                                <div class="border-t pt-4 mt-4 space-y-2 field-group" :class="{'is-hidden': !item.visible}">
                                    <div class="flex justify-between items-center">
                                        <h5 class="font-semibold" x-text="`FAQ #${index + 1}`"></h5>
                                        <div class="flex items-center space-x-3">
                                            <i @click="item.visible = !item.visible" class="visibility-toggle" :data-lucide="item.visible ? 'eye' : 'eye-off'"></i>
                                            <button @click="removeItem('faq', 'items', index)" class="btn-remove"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                        </div>
                                    </div>
                                    <div><label class="label">Pergunta</label><input type="text" x-model="item.q" class="input"></div>
                                    <div><label class="label">Resposta</label><textarea x-model="item.a" rows="3" class="textarea"></textarea></div>
                                </div>
                            </template>
                            <button @click="addItem('faq', 'items')" class="btn-add"><i data-lucide="plus" class="w-4 h-4 mr-2"></i>Adicionar Pergunta</button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Preview Column -->
            <div class="lg:col-span-1 preview-pane overflow-y-auto" style="height: calc(100vh - 68px);">
                <div class="p-4" id="preview-content">
                    
                    <!-- Hero Section Preview -->
                    <template x-if="pageData.hero.visible">
                        <section class="py-12 text-center">
                            <template x-if="pageData.hero.headline1.visible"><h1 class="text-4xl md:text-5xl font-black tracking-tighter mb-4" x-html="pageData.hero.headline1.value"></h1></template>
                            <template x-if="pageData.hero.headline2.visible"><h2 class="text-4xl md:text-5xl font-black tracking-tighter mb-6" x-html="pageData.hero.headline2.value"></h2></template>
                            <template x-if="pageData.hero.paragraph.visible"><p class="text-lg max-w-2xl mx-auto text-gray-300 mb-8" x-html="pageData.hero.paragraph.value"></p></template>
                            <template x-if="pageData.hero.videoUrl.visible"><div class="video-container max-w-2xl mx-auto mb-10"><iframe :src="pageData.hero.videoUrl.value" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div></template>
                            <template x-if="pageData.hero.ctaButtonText.visible"><a :href="pageData.hero.ctaLink.value" target="_blank" class="inline-block bg-gradient-to-r from-cyan-400 via-purple-600 to-pink-600 text-white font-bold text-xl py-4 px-10 rounded-lg" x-text="pageData.hero.ctaButtonText.value"></a></template>
                        </section>
                    </template>
                    
                    <!-- Problem Section Preview -->
                    <template x-if="pageData.problem.visible">
                        <section class="py-16 px-4">
                            <div class="max-w-4xl mx-auto text-center">
                                <template x-if="pageData.problem.title.visible"><h2 class="text-3xl font-bold mb-12" x-html="pageData.problem.title.value"></h2></template>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-10">
                                    <template x-for="(point, index) in pageData.problem.points" :key="index">
                                        <div x-show="point.visible" class="ui-panel p-6 rounded-xl text-center">
                                            <i :data-lucide="['clock', 'puzzle', 'lightbulb-off'][index % 3]" class="w-10 h-10 mx-auto mb-3" :class="['text-cyan-400', 'text-purple-400', 'text-pink-400'][index % 3]"></i>
                                            <h3 class="text-xl font-bold mb-2" x-text="point.title"></h3>
                                            <p class="text-gray-400 text-sm" x-text="point.desc"></p>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </section>
                    </template>

                    <!-- Solution Section Preview -->
                    <template x-if="pageData.solution.visible">
                        <section class="py-16 px-4">
                            <div class="max-w-4xl mx-auto flex flex-col md:flex-row items-center gap-12 ui-panel p-8 rounded-2xl">
                                <template x-if="pageData.solution.imageUrl.visible"><div class="md:w-1/2"><img :src="pageData.solution.imageUrl.value" class="rounded-2xl shadow-2xl shadow-cyan-500/20"></div></template>
                                <div class="md:w-1/2 text-center md:text-left">
                                    <template x-if="pageData.solution.title.visible"><h2 class="text-3xl font-bold mb-4" x-html="pageData.solution.title.value"></h2></template>
                                    <template x-if="pageData.solution.description.visible"><p class="text-lg text-gray-300 mb-6" x-text="pageData.solution.description.value"></p></template>
                                    <ul class="space-y-4 text-left">
                                        <template x-for="(feature, index) in pageData.solution.features" :key="index">
                                            <li x-show="feature.visible" class="flex items-start">
                                                <i :data-lucide="['brain-circuit', 'layers', 'library'][index % 3]" class="w-6 h-6 mr-3 mt-1 flex-shrink-0" :class="['text-cyan-400', 'text-purple-400', 'text-pink-400'][index % 3]"></i>
                                                <span><strong class="text-white" x-text="feature.title + ':'"></strong> <span x-text="feature.desc"></span></span>
                                            </li>
                                        </template>
                                    </ul>
                                </div>
                            </div>
                        </section>
                    </template>
                    
                    <!-- Testimonials Section Preview -->
                    <template x-if="pageData.testimonials.visible">
                        <section class="py-16 px-4">
                            <div class="max-w-5xl mx-auto text-center">
                                <template x-if="pageData.testimonials.title.visible"><h2 class="text-3xl font-bold mb-12" x-text="pageData.testimonials.title.value"></h2></template>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-left">
                                    <template x-for="(testimonial, index) in pageData.testimonials.items" :key="index">
                                        <div x-show="testimonial.visible" class="ui-panel p-6 rounded-xl">
                                            <img :src="testimonial.image" class="w-16 h-16 rounded-full mb-4 border-2" :class="['border-cyan-500', 'border-purple-500', 'border-pink-500'][index % 3]">
                                            <h4 class="font-bold text-white" x-text="testimonial.name"></h4>
                                            <p class="text-sm text-gray-500" x-text="testimonial.role"></p>
                                            <p class="text-gray-300 mt-4" x-text="testimonial.text"></p>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </section>
                    </template>

                    <!-- Offer Section Preview -->
                    <template x-if="pageData.offer.visible">
                        <section class="py-16 px-4">
                            <div class="max-w-3xl mx-auto text-center ui-panel border-2 border-purple-500 rounded-2xl p-8 md:p-12">
                                <template x-if="pageData.offer.title.visible"><h2 class="text-3xl font-black mb-4" x-html="pageData.offer.title.value"></h2></template>
                                <template x-if="pageData.offer.subtitle.visible"><p class="text-lg text-gray-300 mb-6" x-text="pageData.offer.subtitle.value"></p></template>
                                <div class="bg-black p-6 rounded-lg mb-6 border border-gray-700">
                                    <template x-if="pageData.offer.oldPrice.visible"><p class="text-xl text-gray-500 line-through" x-text="pageData.offer.oldPrice.value"></p></template>
                                    <p class="text-2xl text-white">Por apenas</p>
                                    <template x-if="pageData.offer.price.visible"><p class="text-5xl font-extrabold text-white my-2" x-text="pageData.offer.price.value"></p></template>
                                    <template x-if="pageData.offer.fullPrice.visible"><p class="text-xl text-white" x-text="pageData.offer.fullPrice.value"></p></template>
                                </div>
                                <div class="text-left bg-gray-900 bg-opacity-50 p-6 rounded-lg mb-8 border border-gray-700">
                                    <template x-if="pageData.offer.bonusTitle.visible"><h3 class="text-xl font-bold text-center mb-4" x-html="pageData.offer.bonusTitle.value"></h3></template>
                                    <ul class="space-y-3">
                                        <template x-for="bonus in pageData.offer.bonuses" :key="bonus.text">
                                            <li x-show="bonus.visible" class="flex items-center"><i data-lucide="check-circle-2" class="w-5 h-5 mr-2 text-green-400"></i><strong x-text="bonus.text"></strong></li>
                                        </template>
                                    </ul>
                                </div>
                                <template x-if="pageData.offer.ctaButtonText.visible"><a :href="pageData.hero.ctaLink.value" target="_blank" class="w-full block bg-gradient-to-r from-cyan-400 via-purple-600 to-pink-600 text-white font-bold text-2xl py-5 px-10 rounded-lg mb-4" x-text="pageData.offer.ctaButtonText.value"></a></template>
                            </div>
                        </section>
                    </template>

                    <!-- Guarantee Section Preview -->
                    <template x-if="pageData.guarantee.visible">
                        <section class="py-16 px-4">
                            <div class="max-w-3xl mx-auto flex flex-col md:flex-row items-center gap-8 ui-panel p-8 rounded-2xl">
                                <template x-if="pageData.guarantee.imageUrl.visible"><div class="flex-shrink-0"><img :src="pageData.guarantee.imageUrl.value" class="w-32 h-32 rounded-full border-4 border-cyan-400"></div></template>
                                <div>
                                    <template x-if="pageData.guarantee.title.visible"><h3 class="text-2xl font-bold mb-2" x-text="pageData.guarantee.title.value"></h3></template>
                                    <template x-if="pageData.guarantee.text.visible"><p class="text-gray-400" x-text="pageData.guarantee.text.value"></p></template>
                                </div>
                            </div>
                        </section>
                    </template>

                    <!-- FAQ Section Preview -->
                    <template x-if="pageData.faq.visible">
                        <section class="py-16 px-4">
                            <div class="max-w-3xl mx-auto" x-data="{ open: 0 }">
                                <template x-if="pageData.faq.title.visible"><h2 class="text-3xl font-bold text-center mb-12" x-text="pageData.faq.title.value"></h2></template>
                                <div class="space-y-4">
                                    <template x-for="(item, index) in pageData.faq.items" :key="index">
                                        <div x-show="item.visible" class="ui-panel rounded-lg">
                                            <button @click="open = open === index ? null : index" class="w-full text-left p-5 font-semibold text-lg flex justify-between items-center">
                                                <span x-text="item.q"></span>
                                                <i data-lucide="chevron-down" class="w-5 h-5 transition-transform" :class="{'rotate-180': open === index}"></i>
                                            </button>
                                            <div x-show="open === index" x-transition class="p-5 pt-0 text-gray-400" x-text="item.a"></div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </section>
                    </template>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div x-show="toast.show" x-transition class="fixed bottom-5 right-5 text-white py-2 px-5 rounded-lg shadow-lg" :class="toast.type === 'success' ? 'bg-green-600' : 'bg-red-600'" x-text="toast.message" x-cloak></div>
    </div>
</body>
</html>
